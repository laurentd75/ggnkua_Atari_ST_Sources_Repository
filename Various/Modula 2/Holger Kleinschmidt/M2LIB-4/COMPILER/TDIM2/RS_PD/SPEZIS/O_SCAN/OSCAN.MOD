IMPLEMENTATION MODULE OScan;
(* ½ 1991-95 ROLF SCHRADER. * 1.5.91 ~ 5.5.94 *)
(*$S-,$T-,$Q+*)

FROM  SYSTEM IMPORT ADDRESS, REGISTER, CODE;

TYPE  IG = INTEGER; AD = ADDRESS;
CONST XBIOSTRAP = 4E40H +14; PUSHW = 3F3CH; PUSHP = 3F2EH; PM = 8;
VAR   ja: IG;

PROCEDURE Exist (): BOOLEAN; BEGIN RETURN (4200 # Version ()) END Exist;

PROCEDURE Norm; BEGIN ja := PhyEmu (1) + SetLock (1) + VBtest (1) END Norm;

PROCEDURE Version (): (*asBCD:*) CARDINAL;
 BEGIN CODE (PUSHW,4200, XBIOSTRAP);
   RETURN CARDINAL (REGISTER (0)); END Version;

PROCEDURE PatchPtr (): AD;
 BEGIN CODE (PUSHW,4205, XBIOSTRAP);
   RETURN AD (REGISTER (0)); END PatchPtr;

PROCEDURE TablePtr (Rez: IG): AD;
 BEGIN CODE (PUSHP,PM, PUSHW,4201, XBIOSTRAP);
   RETURN AD (REGISTER (0)); END TablePtr;

PROCEDURE PhyEmu (Mode: IG): IG;
 BEGIN CODE (PUSHP,PM, PUSHW,4202, XBIOSTRAP);
   RETURN IG (REGISTER (0)); END PhyEmu;

PROCEDURE SetLock(Mode: IG): IG;
 BEGIN CODE (PUSHP,PM, PUSHW,4203, XBIOSTRAP);
   RETURN IG (REGISTER (0)); END SetLock;

PROCEDURE VBtest (Mode: IG): IG;
 BEGIN CODE (PUSHP,PM, PUSHW,4204, XBIOSTRAP);
   RETURN IG (REGISTER (0)); END VBtest;

PROCEDURE Switch (Mode: IG): IG;
 BEGIN CODE (PUSHP,PM, PUSHW,4206, XBIOSTRAP);
   RETURN IG (REGISTER (0)); END Switch;

BEGIN ja := PhyEmu (0) + SetLock (0) END OScan.
