*THE EDDIE PALETTE EXTENSION FOR STOS USERS
*USES 2 LOTS OF PALETTE DATA (WORDS)
*AND MAKES INTERUPT COLOUR BARSIN COLOUR 0 AND 1
*ENETER A0 POINTING TO COL 0, A1 TO COLOUR 1.

*EDDIE 3 DECEMBER 1991

	MOVE.B	CHECK,D0
	CMP.B	#1,D0
	BEQ	STOP_TIME

	MOVE.B	#1,CHECK

	MOVE.L	A0,COLOURS
	MOVE.L	A1,COLOURS_1





	MOVE.L $118.W,OLD118
	MOVE.L $120.W,OLD120
	MOVE.L $70.W,OLD70
	MOVE.B $FFFFFA07.W,OLDA07
	MOVE.B $FFFFFA13.W,OLDA13
	MOVE.B $FFFFFA1B.W,OLDA1B
	MOVE.B $FFFFFA21.W,OLDA21
	DC.W $A000
	DC.W $A00A			;HIDE MOUSE
	MOVE.B #$12,$FFFFFC02.W 	;DISABLE MOUSE

	MOVE.W #5,-(A7)			;5=TIMER C INTERRUPT
	MOVE.W #26,-(A7)		;26=DISBALE INTERRUPT
	TRAP #14
	ADDQ.L #4,A7

 	ORI.B #1,$FFFFFA07.W		;ENABLE TIMER B
	ORI.B #1,$FFFFFA13.W
	MOVE.L #TIMERB,$120.W
	MOVE.L #VBL,$70.W

	RTS				*BACK WE GO
STOP_TIME
	MOVE.W	#0,CHECK
*	MOVE.W #$2700,SR		;DISBALE INTERRUPTS
	MOVE.L OLD70,$70.W
	MOVE.L OLD120,$120.W
	MOVE.L OLD118,$118.W
	MOVE.B OLDA07,$FFFFFA07.W
	MOVE.B OLDA13,$FFFFFA13.W
	MOVE.B OLDA1B,$FFFFFA1B.W
	MOVE.B OLDA21,$FFFFFA21.W
	MOVE.W #5,-(A7)			;5=TIMER C INTERRUPT
	MOVE.W #27,-(A7)		;27=ENABLE INTERRUPT
	TRAP #14
	ADDQ.L #4,A7
	DC.W $A000
	DC.W $A009			;SHOW MOUSE
	MOVE.B #$08,$FFFFFC02.W 	;ENABLE MOUSE
	MOVE.W #$000,$FFFF8240.W	
	MOVE.W	#$000,$FFFF8240.W
	MOVE.W #$2300,SR
	RTS






VBL	CLR.B $FFFFFA1B.W	    	;STOP TIMER B FOR SYNCRONISATION
	ADD.L	#1,$462
	ADD.L	#1,$466			
	MOVE.B #10,$FFFFFA21.W      
	MOVE.L COLOURS+2,PAL       
	MOVE.L	COLOURS_1+2,PAL_1

	MOVE.L	A0,-(A7)
	MOVE.L	COLOURS,A0
        MOVE.W (A0),$FFFF8240.W
	MOVE.L	COLOURS_1,A0
	MOVE.W	(A0),$FFFF8242.W  

	MOVE.L	(A7)+,A0
	MOVE.B #8,$FFFFFA1B.W	    
	RTE			    

TIMERB	CLR.B $FFFFFA1B.W	    ;STOP TIMER B
	MOVE.L A0,-(A7)		    ;SAVE A0

	MOVEA.L PAL,A0              ;A0=ADDRESS OF COLOUR
	MOVE.W (A0)+,$FFFF8240.W    ;COLOUR=0 NEW COLOUR
        MOVE.L A0,PAL		    ;PAL=NEXT COLOUR IN TABLE

	MOVEA.L	PAL_1,A0
	MOVE.W	(A0)+,$FFFF8242.W
	MOVE.L	A0,PAL_1

	MOVEA.L (A7)+,A0	    ;RESTORE A0
	MOVE.B #10,$FFFFFA21.W      ;COUNTER=10 SCANLINES
	MOVE.B #8,$FFFFFA1B.W	    ;START TIMER B
	BCLR #0,$FFFFFA0F.W	    ;I'VE DONE THE ROUTINE
	RTE			    ;GO AWAY



PAL		DC.L	0
PAL_1 		DC.L	0

COLOURS	        DC.L	0
COLOURS_1	DC.L	0

OLD70	DS.L 1
OLD118	DS.L 1
OLD120	DS.L 1
OLDA07	DS.B 1
OLDA13	DS.B 1
OLDA21	DS.B 1
OLDA1B	DS.B 1
STACK	DS.L 1
CHECK	DC.B	0
	EVEN