**********************************************
* THE HAPPENING BOIZ PRESENT THE VOLUME      *
* EXTENSION 3 !! - TWIN METERS               *
*AREG(0) - DEST POS FOR BARS		     *
*EG AREG(0)=PHYSIC+16000(HALF WAY DOWN SCREEN*
**********************************************
VOLUME_4
	MOVEQ.W #0,D0
	MOVEQ.W #0,D1
	MOVEQ.W #0,D2
	MOVE.W	#65534,D6
	MOVE.B #8,$FFFF8800.W  	
	MOVE.B $FFFF8800.W,D0
	MOVE.B #9,$FFFF8800.W   
	MOVE.B $FFFF8800.W,D1
	MOVE.B #10,$FFFF8800.W  
	MOVE.B $FFFF8800.W,D2
	BTST #4,D0              
	BEQ .L1
	MOVE.B #10,D0           
.L1	BTST #4,D1    		
       	BEQ .L2
	MOVE.B #10,D1
.L2	BTST #4,D2		
	BEQ .L3
	MOVE.B #10,D2			*READ SOUND CHIP
.L3 	
	MULU	#15,D0
	MULU	#15,D1
	MULU	#15,D2
	JSR	CH_1
	JSR	CH_2			*GO TO METER DRAW
	JSR	CH_3			*ROUTINES
STOP_NOW
	RTS				*BACK TO BASIC
	
*ROUTINES TO DRAW VOLUME BARS

CH_1
	MOVE.L	#VOL,A1
	ADD.W	D0,A1			*GET CORRECT VOLUME
	MOVE.L	A0,A2			
	MOVE.L	A0,A3
	MOVE.W	#14,D4			*COUNTER
CH_1_L
	MOVE.B	(A1)+,D5		*GET NEXT ONE
	CMP.B	#1,D5
	BEQ	CH_1_DRAW
	MOVE.W	#0,8(A2)
	MOVE.W	#0,8(A3)
	MOVE.W	#0,128(A2)
	MOVE.W	#0,128(A3)		*SILENT THEN UNDRAW BAR
CH_1_LL
	SUB.L	#320,A2
	ADD.L	#320,A3
	DBF	D4,CH_1_L
	RTS
CH_1_DRAW
	MOVE.W	D6,8(A2)
	MOVE.W	D6,8(A3)
	MOVE.W	D6,128(A2)
	MOVE.W	D6,128(A3)		*DRAW I PLANE WORD
	BRA	CH_1_LL
***************************
CH_2
	MOVE.L	#VOL,A1
	ADD.W	D1,A1
	MOVE.L	A0,A2
	MOVE.L	A0,A3
	MOVE.W	#14,D4
CH_2_L
	MOVE.B	(A1)+,D5
	CMP.B	#1,D5
	BEQ	CH_2_DRAW
	MOVE.W	#0,16(A2)
	MOVE.W	#0,16(A3)
	MOVE.W	#0,136(A2)
	MOVE.W	#0,136(A3)
CH_2_LL
	SUB.L	#320,A2
	ADD.L	#320,A3
	DBF	D4,CH_2_L
	RTS
CH_2_DRAW
	MOVE.W	D6,16(A2)
	MOVE.W	D6,16(A3)
	MOVE.W	D6,136(A2)
	MOVE.W	D6,136(A3)
	BRA	CH_2_LL
***************************
CH_3
	MOVE.L	#VOL,A1
	ADD.W	D2,A1
	MOVE.L	A0,A2
	MOVE.L	A0,A3
	MOVE.W	#14,D4
CH_3_L
	MOVE.B	(A1)+,D5
	CMP.B	#1,D5
	BEQ	CH_3_DRAW
	MOVE.W	#0,24(A2)
	MOVE.W	#0,24(A3)
	MOVE.W	#0,144(A2)
	MOVE.W	#0,144(A3)
CH_3_LL
	SUB.L	#320,A2
	ADD.L	#320,A3
	DBF	D4,CH_3_L
	RTS
CH_3_DRAW
	MOVE.W	D6,24(A2)
	MOVE.W	D6,24(A3)
	MOVE.W	D6,144(A2)
	MOVE.W	D6,144(A3)
	BRA	CH_3_LL


**********************************
*THIS IS THE VOLUME LOOK UP TABLE*
**********************************

VOL	DC.B	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	DC.B	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	DC.B	1,1,0,0,0,0,0,0,0,0,0,0,0,0,0
	DC.B	1,1,1,0,0,0,0,0,0,0,0,0,0,0,0
	DC.B	1,1,1,1,0,0,0,0,0,0,0,0,0,0,0
	DC.B	1,1,1,1,1,0,0,0,0,0,0,0,0,0,0
	DC.B    1,1,1,1,1,1,0,0,0,0,0,0,0,0,0
	DC.B    1,1,1,1,1,1,1,0,0,0,0,0,0,0,0
	DC.B    1,1,1,1,1,1,1,1,0,0,0,0,0,0,0
	DC.B    1,1,1,1,1,1,1,1,1,0,0,0,0,0,0
	DC.B    1,1,1,1,1,1,1,1,1,1,0,0,0,0,0
	DC.B    1,1,1,1,1,1,1,1,1,1,1,0,0,0,0
	DC.B    1,1,1,1,1,1,1,1,1,1,1,1,0,0,0
	DC.B    1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
	DC.B    1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
	DC.B    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
	EVEN